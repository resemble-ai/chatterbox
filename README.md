# Chattractive

Chattractive ‚Äî Telegram‚Äë–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ–± –ò–¢–ú–û –∏ —É–º–µ–µ—Ç –æ–∑–≤—É—á–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã.
–û–Ω —Å–æ—á–µ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –∑–Ω–∞–Ω–∏–π, –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ Gemini –∏ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—É—é –æ–∑–≤—É—á–∫—É Chatterbox.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìö **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π**: –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ `data/` —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã,
  –¥–ª—è –Ω–∏—Ö —Å—Ç—Ä–æ–∏—Ç—Å—è TF‚ÄëIDF‚Äë—ç–º–±–µ–¥–¥–∏–Ω–≥, –∞ –æ—Ç–≤–µ—Ç—ã –ø–æ–¥–±–∏—Ä–∞—é—Ç—Å—è –ø–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–π –±–ª–∏–∑–æ—Å—Ç–∏.
- üí¨ **–î–∏–∞–ª–æ–≥ —Å –ø–∞–º—è—Ç—å—é**: –∏—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ SQLite –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ Gemini.
- üë®‚Äçüë©‚Äçüëß **–†—É—á–Ω–æ–π —Ä–µ–∂–∏–º**: —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—ã–ª–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º –∏ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –∏–∑ –≥—Ä—É–ø–ø—ã.
- üîä **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: –ø–æ –∂–µ–ª–∞–Ω–∏—é –±–æ—Ç –ø—Ä–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã —á–µ—Ä–µ–∑ Chatterbox.
- üßπ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã**: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–∏–∞–ª–æ–≥–∞, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –∏ –≥–æ–ª–æ—Å–∞ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:

   ```bash
   -3.11 -m venv venv
   venv/Scripts/Activate
   pip install -e .

   #–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cuda, –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å VOICE_DEVICE=cuda –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã:

   pip uninstall torch torchaudio
   pip install --index-url https://download.pytorch.org/whl/cu124 torch==2.6.0 torchaudio==2.6.0
   ```

2. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `env.example` –≤ `.env` –∏ –ø—Ä–æ–ø–∏—à–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è:

   ```bash
   cp env.example .env
   ```

   –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

   - `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞.
   - `GOOGLE_API_KEY` ‚Äî –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ Gemini.
   - `ADMIN_GROUP_ID` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä Telegram‚Äë–≥—Ä—É–ø–ø—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.

   –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

   - `DATA_DIRECTORY` ‚Äî –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å —Ç–µ–∫—Å—Ç–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `data`).
   - `DATABASE_PATH` ‚Äî –ø—É—Ç—å –∫ SQLite‚Äë—Ñ–∞–π–ª—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `chattractive.db`).
   - `GEMINI_MODEL` ‚Äî –º–æ–¥–µ–ª—å Gemini (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `gemini-2.0-flash-exp`).
   - `AUDIO_MODEL_DIR` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ —Å –≤–µ—Å–∞–º–∏ Chatterbox (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `./models`).
   - `VOICE_DEVICE` ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è TTS (`cpu`, `cuda`, `mps`).
   - `VOICE_LANGUAGE` ‚Äî —è–∑—ã–∫ —Å–∏–Ω—Ç–µ–∑–∞ (`ru`, `en`, –∏ —Ç.–¥.).

3. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ**. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ `data/` —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (`.txt`, `.md`, `.rst`) —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π.

4. **–°–∫–∞—á–∞–π—Ç–µ –≤–µ—Å–∞ TTS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**:

   ```bash
   python load_model.py
   ```

   –ö–æ–º–∞–Ω–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—É—é –º–æ–¥–µ–ª—å Chatterbox –≤ –∫–∞—Ç–∞–ª–æ–≥ `models/`. –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—É—Ç—å —á–µ—Ä–µ–∑ `AUDIO_MODEL_DIR`.

5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞**:

   ```bash
   python main.py
   ```

   –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –±–∞–∑—É –∑–Ω–∞–Ω–∏–π, –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ Gemini –∏ –Ω–∞—á–Ω—ë—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
chattractive/
‚îú‚îÄ‚îÄ ai/                # —Ä–∞–±–æ—Ç–∞ —Å Gemini –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–ó
‚îú‚îÄ‚îÄ audio/             # –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Chatterbox –∏ –≥–æ–ª–æ—Å–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–æ–º
‚îú‚îÄ‚îÄ bot/               # Telegram-–ª–æ–≥–∏–∫–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ db/                # —Å–ª–æ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Å–ª—É–∂–µ–±–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îî‚îÄ‚îÄ vendor/chatterbox/ # –≤–µ–Ω–¥–æ—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏ TTS (Resemble AI)
```

- `chattractive/ai/knowledge_base.py` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫.
- `chattractive/ai/chat_service.py` ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ –∏ –¥–∏–∞–ª–æ–≥ —Å Gemini.
- `chattractive/db/storage.py` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å SQLite –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –±–æ—Ç–∞.
- `chattractive/bot/bot.py` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π Telegram –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤.
- `chattractive/audio/voice_service.py` ‚Äî –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ç–µ–∫—Å—Ç–∞.
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∏ —Å–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

## –ì–æ–ª–æ—Å–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã

`VoiceSynthesizer` –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å Chatterbox –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Gemini —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.
–í –ª–æ–≥–∞—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–∏—à—å —É–∫–æ—Ä–æ—á–µ–Ω–Ω—ã–µ –ø—Ä–µ–≤—å—é –æ—Ç–≤–µ—Ç–æ–≤, –ø–æ—ç—Ç–æ–º—É —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ INFO‚Äë–ª–æ–≥–∏.
–ß—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å, –ø–æ–º–µ—Å—Ç–∏—Ç–µ —ç—Ç–∞–ª–æ–Ω –≤ —Ñ–∞–π–ª –∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `VOICE_PATH`.

## –†—É—á–Ω–æ–π —Ä–µ–∂–∏–º

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –≤ –≥—Ä—É–ø–ø—É `ADMIN_GROUP_ID`.
–û—Ç–≤–µ—Ç –∏–∑ –≥—Ä—É–ø–ø—ã, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤ —Ä–µ–∂–∏–º–µ ¬´–æ—Ç–≤–µ—Ç–∏—Ç—å¬ª, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
(–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–µ–∫—Å—Ç, –≥–æ–ª–æ—Å –∏ –≤–ª–æ–∂–µ–Ω–∏—è). –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –±–∞–∑–æ–π –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π.
